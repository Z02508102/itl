package com.zpx.itl.controller;

import java.io.UnsupportedEncodingException;
import java.util.List;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;

import com.zpx.itl.pojo.InfoList;
import com.zpx.itl.pojo.PageBean;
import com.zpx.itl.pojo.User;
import com.zpx.itl.service.InfoService;

/**
 * 管理页面
 * @author ZPX
 *
 */
@Controller
public class InfoController {

	@Autowired
	private InfoService infoService;
	private PageBean<InfoList> pageBean;
	
	private int index; // 从第几条开始查
	
	@RequestMapping("/item/infoList")
	public String getItem(HttpServletRequest request, HttpServletResponse response) throws Exception {
		
		HttpSession session = request.getSession();
		User user = (User) session.getAttribute("user");
		if(user != null) {
			request.setCharacterEncoding("utf-8");
			response.setContentType("text/html;charset=utf-8");
		
			index = 0;
			int pageSize = 10;
			List<InfoList> list = infoService.findAll(index, pageSize);
			session.setAttribute("infoList", list);
		}
		
		return null;
		
		/*
		HttpSession session = request.getSession();
		User user = (User) session.getAttribute("user");
		if(user != null) {
			
			request.setCharacterEncoding("utf-8");
			response.setContentType("text/html;charset=utf-8");
			//当前页
			int pc = getPc(request);
			//每页显示10条数据
			int ps = 10;
			PageBean pb;
			try {
				infoService.findAll();
				request.setAttribute("pb", pb);
			} catch (SQLException e) {
				e.printStackTrace();
			}
			request.getRequestDispatcher("/information.jsp").forward(request, response);
		}else {
			
			response.sendRedirect(request.getContextPath() + "/login.jsp");
		}
	}

	private int getPc(HttpServletRequest request) throws ServletException, IOException {
		String pc = request.getParameter("pc");
		if ((pc == null) || (pc.trim().isEmpty()))
			return 1;
		int pc1 = Integer.parseInt(pc);
		return pc1;
		
		*/
		
	}
}
